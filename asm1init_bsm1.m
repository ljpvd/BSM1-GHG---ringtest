% This initialization file was created//modified by Xavier Flores-Alsina% BSM2 including GHG emissions % modelEAU, Department of Civil Engineering, Laval University, Quebec,(Canada)% IEA, Div of Industrial Electrical Engineering and Automation, Lund University, Lund (Sweden)% December 2012Qin0 = 18446;% if (exist('in'))%   Qin = in(end,15);% else%   Qin = Qin0;% end% % if (exist('rec'))%   Qintr = rec(end,15);% else%   Qintr = 3*Qin0;% end% % if (exist('settler'))%   Qr = settler(end,15);% else%   Qr = Qin0;% end% % if (exist('settler'))%   Qw = settler(end,22);% else%   Qw = 300;% endQin = Qin0;Qintr = 3*Qin0;Qr = Qin0;Qw = 385;          % The following states represent concentrations in different AS reactors (1% to 5) S_I1 =  28.0643;S_S1 =  3.0503;X_I1 =  1532.3;X_S1 =  63.0433;X_BH1 = 2245.1;X_BA1 = 166.6699;X_P1 =  964.8992;S_O1 =  0.0093;S_NO1 = 3.9350;S_NH1 = 6.8924;S_ND1 = 0.9580;X_ND1 = 3.8453;S_ALK1 = 5.4213;TSS1 = 3729.0;Q1 = 103533;T1 = 14.8581;S_NO2_1 = 0;S_NO_1 = 0;S_N2O_1 = 0;S_N2_1 = 0;X_BA2_1 = 1;S_D1_1 = 0;S_D2_1 = 0;S_D3_1 = 0;X_D4_1 = 0;X_D5_1 = 0; S_I2 =  28.0643;S_S2 =  1.3412;X_I2 =  1532.3;X_S2 =  58.8579;X_BH2 = 2245.4;X_BA2 = 166.5512;X_P2 =  965.6805;S_O2 =  1.0907e-4;S_NO2 = 2.2207;S_NH2 = 7.2028;S_ND2 = 0.6862;X_ND2 = 3.7424;S_ALK2 = 5.5659;TSS2 = 3726.6;Q2 = 103533;T2 = 14.8581;S_NO2_2 = 0;S_NO_2 = 0;S_N2O_2 = 0;S_N2_2 = 0;X_BA2_2 = 1;S_D1_2 = 0;S_D2_2 = 0;S_D3_2 = 0;X_D4_2 = 0;X_D5_2 = 0; S_I3 =  28.0643;S_S3 =  0.9553;X_I3 =  1532.3;X_S3 =  46.2983;X_BH3 = 2246.8;X_BA3 = 167.3077;X_P3 =  967.2442;S_O3 =  0.4663;S_NO3 = 5.5141;S_NH3 = 3.4247;S_ND3 = 0.6513;X_ND3 = 3.1405;S_ALK3 = 5.0608;TSS3 = 3719.9;Q3 = 103533;T3 = 14.8581;S_NO2_3 = 0;S_NO_3 = 0;S_N2O_3 = 0;S_N2_3 = 0;X_BA2_3 = 1;S_D1_3 = 0;S_D2_3 = 0;S_D3_3 = 0;X_D4_3 = 0;X_D5_3 = 0; S_I4 =  28.0643;S_S4 =  0.7806;X_I4 =  1532.3;X_S4 =  37.3881;X_BH4 = 2245.6;X_BA4 = 167.8339;X_P4 =  968.8072;S_O4 =  1.4284;S_NO4 = 8.4066;S_NH4 = 0.6922;S_ND4 = 0.6094;X_ND4 = 2.6815;S_ALK4 = 4.6590;TSS4 = 3713.9;Q4 = 103533;T4 = 14.8581;S_NO2_4 = 0;S_NO_4 = 0;S_N2O_4 = 0;S_N2_4 = 0;X_BA2_4 = 1;S_D1_4 = 0;S_D2_4 = 0;S_D3_4 = 0;X_D4_4 = 0;X_D5_4 = 0; S_I5 =  28.0643;S_S5 =  0.6734;X_I5 =  1532.3;X_S5 =  31.9144;X_BH5 = 2242.1;X_BA5 = 167.8482;X_P5 =  970.3678;S_O5 =  1.3748;S_NO5 = 9.1948;S_NH5 = 0.1585;S_ND5 = 0.5594;X_ND5 = 2.3926;S_ALK5 = 4.5646;TSS5 = 3708.4;Q5 = 103533;T5 = 14.8581;S_NO2_5 = 0;S_NO_5 = 0;S_N2O_5 = 0;S_N2_5 = 0;X_BA2_5 = 1;S_D1_5 = 0;S_D2_5 = 0;S_D3_5 = 0;X_D4_5 = 0;X_D5_5 = 0;XINIT1 = [ S_I1  S_S1  X_I1  X_S1  X_BH1  X_BA1  X_P1  S_O1  S_NO1  S_NH1  S_ND1  X_ND1  S_ALK1 TSS1 Q1 T1   S_NO2_1 S_NO_1 S_N2O_1 S_N2_1 X_BA2_1   S_D1_1 S_D2_1 S_D3_1 X_D4_1 X_D5_1 ];XINIT2 = [ S_I2  S_S2  X_I2  X_S2  X_BH2  X_BA2  X_P2  S_O2  S_NO2  S_NH2  S_ND2  X_ND2  S_ALK2 TSS2 Q2 T2   S_NO2_2 S_NO_2 S_N2O_2 S_N2_2 X_BA2_2   S_D1_2 S_D2_2 S_D3_2 X_D4_2 X_D5_2 ];XINIT3 = [ S_I3  S_S3  X_I3  X_S3  X_BH3  X_BA3  X_P3  S_O3  S_NO3  S_NH3  S_ND3  X_ND3  S_ALK3 TSS3 Q3 T3   S_NO2_3 S_NO_3 S_N2O_3 S_N2_3 X_BA2_3   S_D1_3 S_D2_3 S_D3_3 X_D4_3 X_D5_3 ];XINIT4 = [ S_I4  S_S4  X_I4  X_S4  X_BH4  X_BA4  X_P4  S_O4  S_NO4  S_NH4  S_ND4  X_ND4  S_ALK4 TSS4 Q4 T4   S_NO2_4 S_NO_4 S_N2O_4 S_N2_4 X_BA2_4   S_D1_4 S_D2_4 S_D3_4 X_D4_4 X_D5_4 ];XINIT5 = [ S_I5  S_S5  X_I5  X_S5  X_BH5  X_BA5  X_P5  S_O5  S_NO5  S_NH5  S_ND5  X_ND5  S_ALK5 TSS5 Q5 T5   S_NO2_5 S_NO_5 S_N2O_5 S_N2_5 X_BA2_5   S_D1_5 S_D2_5 S_D3_5 X_D4_5 X_D5_5 ];% used to avoid stiff solver to get stuck when running steady state for% long time periods and starting to close to correct valueXINIT1 = XINIT1.*(rand(1, 26)/5);XINIT2 = XINIT2.*(rand(1, 26)/5);XINIT3 = XINIT3.*(rand(1, 26)/5);XINIT4 = XINIT4.*(rand(1, 26)/5);XINIT5 = XINIT5.*(rand(1, 26)/5);b_A1	=           0.028;b_A2 =          	0.028;b_H =           	0.3;D_N2	=           1.86E-9;D_N2O	=           1.77E-9;D_NO	=           8.7E-11;D_O2	=           2.12E-9;F_BOD_COD	=       0.65;f_P  =              0.08;F_TSS_COD	=       0.75;H_N2	=           1.64;H_N2O	=           0.04;H_NO	=           0.53;i_X_B	=           0.086;i_X_P	=           0.06;k_a               = 0.07;     % 0.1608K_FA               =0.004;     % 0.002K_FNA              =5E-6;       % 1e-8k_h  =              2.89;      % 4K_I10FA	 =          0.5;K_I10FNA	=       0.1;K_I3NO	=           0.5;K_I4NO	=           0.3;K_I5NO	=           0.2;K_I9FA  =           1;K_I9FNA	=           0.1;K_N2O	=           0.02;K_NO	=           0.04;K_NO2	=           0.3;K_NO3   =           1.5;K_OA1	=           0.6;K_OA2	=           1.2;K_OH	=           0.2;K_OH1	=           0.2;K_OH2	=           0.2;K_OH3	=           0.2;K_OH4	=           0.2;K_OH5	=           0.2;K_S1	=           15;     % 10K_S2	=           20;     % 10K_S3	=           20;     % 10K_S4	=           20;     % 10K_S5	=           30;     % 20K_X	=               0.1;n_g2	=           0.3;    % 0.45n_g3	=           0.3;    % 0.3n_g4	=           0.6;    % 0.5n_g5	=           0.8;    % 0.5n_h	    =           0.8;     % 0.8n_Y	    =           0.9;pH	    =           7;P_N2O_air =     	0;P_N2_air  =         0.78;P_NO_air  =       	0;Y_A1	=           0.18;Y_A2	=           0.06;Y_H	=               0.67;X_I2TSS =           0.75; X_S2TSS =           0.75;X_BH2TSS =          0.75;X_BA2TSS =          0.75;X_P2TSS =           0.75;b_Ratkowsky_mu_A1=	0.0255;b_Ratkowsky_mu_A2=	0.0235;b_Ratkowsky_mu_H=	0.0625;c_Ratkowsky_mu_A1=	0.15;c_Ratkowsky_mu_A2=	0.05;c_Ratkowsky_mu_H=	0.3;Temp_Ref	=       15;theta_b_A1	=       1.116;theta_b_A2	=       1.116;theta_b_H	=       1.12;theta_kla	=       1.024;theta_k_a	=       1.072;theta_k_h	=       1.116;Tmax_Ratkowsky_mu_A1	=   50;Tmax_Ratkowsky_mu_A2	=   57;Tmax_Ratkowsky_mu_H	    =   50;Tmin_Ratkowsky_mu_A1	=   -15;Tmin_Ratkowsky_mu_A2	=   -25;Tmin_Ratkowsky_mu_H	    =   -20;K_SNH_aob1 = 	1.0;K_SNH_aob2= 	1.0;K_SNO2_aob= 	8.0;K_SNO_aob= 	1.0;K_SO_aob1= 	1;K_SO_aob2= 	1;K_SO_AOBden1 = 11.399605;K_IO_AOBden1 = 0.035089;K_SO_AOBden2 = 11.399605;K_IO_AOBden2 = 0.035089;n_AOB        = 0.5;n_Y_AOB      = 0.83;K_FNA_aob    = 0.0006;K_FA_aob     = 0.0027;PAR1 = [b_A1	b_A2	b_H	D_N2	D_N2O	D_NO	D_O2    F_BOD_COD	f_P	F_TSS_COD	H_N2	H_N2O	H_NO	i_X_B	i_X_P	k_a     K_FA	K_FNA	k_h     K_I10FA	K_I10FNA	K_I3NO	K_I4NO	K_I5NO	K_I9FA	K_I9FNA	K_N2O	K_NO	K_NO2	K_NO3	K_OA1	K_OA2	K_OH	K_OH1	K_OH2	K_OH3	K_OH4	K_OH5	K_S1	K_S2	K_S3	K_S4	K_S5	K_X		n_g2	n_g3	n_g4	n_g5	n_h     n_Y     pH	P_N2O_air	P_N2_air	P_NO_air	Y_A1    Y_A2    Y_H     X_I2TSS     X_S2TSS     X_BH2TSS    X_BA2TSS    X_P2TSS b_Ratkowsky_mu_A1	b_Ratkowsky_mu_A2	b_Ratkowsky_mu_H	c_Ratkowsky_mu_A1	c_Ratkowsky_mu_A2	c_Ratkowsky_mu_H	Temp_Ref	theta_b_A1	theta_b_A2	theta_b_H	theta_kla	theta_k_a	theta_k_h	Tmax_Ratkowsky_mu_A1	Tmax_Ratkowsky_mu_A2	Tmax_Ratkowsky_mu_H	Tmin_Ratkowsky_mu_A1	Tmin_Ratkowsky_mu_A2	Tmin_Ratkowsky_mu_H K_SNH_aob1  K_SNH_aob2	K_SNO2_aob	K_SNO_aob	K_SO_aob1	K_SO_aob2   K_SO_AOBden1  K_IO_AOBden1  K_SO_AOBden2  K_IO_AOBden2  n_AOB  n_Y_AOB  K_FNA_aob K_FA_aob];PAR2 = [b_A1	b_A2	b_H	D_N2	D_N2O	D_NO	D_O2    F_BOD_COD	f_P	F_TSS_COD	H_N2	H_N2O	H_NO	i_X_B	i_X_P	k_a     K_FA	K_FNA	k_h     K_I10FA	K_I10FNA	K_I3NO	K_I4NO	K_I5NO	K_I9FA	K_I9FNA	K_N2O	K_NO	K_NO2	K_NO3	K_OA1	K_OA2	K_OH	K_OH1	K_OH2	K_OH3	K_OH4	K_OH5	K_S1	K_S2	K_S3	K_S4	K_S5	K_X		n_g2	n_g3	n_g4	n_g5	n_h     n_Y     pH	P_N2O_air	P_N2_air	P_NO_air	Y_A1    Y_A2    Y_H     X_I2TSS     X_S2TSS     X_BH2TSS    X_BA2TSS    X_P2TSS b_Ratkowsky_mu_A1	b_Ratkowsky_mu_A2	b_Ratkowsky_mu_H	c_Ratkowsky_mu_A1	c_Ratkowsky_mu_A2	c_Ratkowsky_mu_H	Temp_Ref	theta_b_A1	theta_b_A2	theta_b_H	theta_kla	theta_k_a	theta_k_h	Tmax_Ratkowsky_mu_A1	Tmax_Ratkowsky_mu_A2	Tmax_Ratkowsky_mu_H	Tmin_Ratkowsky_mu_A1	Tmin_Ratkowsky_mu_A2	Tmin_Ratkowsky_mu_H K_SNH_aob1  K_SNH_aob2	K_SNO2_aob	K_SNO_aob	K_SO_aob1	K_SO_aob2   K_SO_AOBden1  K_IO_AOBden1  K_SO_AOBden2  K_IO_AOBden2  n_AOB  n_Y_AOB  K_FNA_aob K_FA_aob];PAR3 = [b_A1	b_A2	b_H	D_N2	D_N2O	D_NO	D_O2    F_BOD_COD	f_P	F_TSS_COD	H_N2	H_N2O	H_NO	i_X_B	i_X_P	k_a     K_FA	K_FNA	k_h     K_I10FA	K_I10FNA	K_I3NO	K_I4NO	K_I5NO	K_I9FA	K_I9FNA	K_N2O	K_NO	K_NO2	K_NO3	K_OA1	K_OA2	K_OH	K_OH1	K_OH2	K_OH3	K_OH4	K_OH5	K_S1	K_S2	K_S3	K_S4	K_S5	K_X		n_g2	n_g3	n_g4	n_g5	n_h     n_Y     pH	P_N2O_air	P_N2_air	P_NO_air	Y_A1    Y_A2    Y_H     X_I2TSS     X_S2TSS     X_BH2TSS    X_BA2TSS    X_P2TSS b_Ratkowsky_mu_A1	b_Ratkowsky_mu_A2	b_Ratkowsky_mu_H	c_Ratkowsky_mu_A1	c_Ratkowsky_mu_A2	c_Ratkowsky_mu_H	Temp_Ref	theta_b_A1	theta_b_A2	theta_b_H	theta_kla	theta_k_a	theta_k_h	Tmax_Ratkowsky_mu_A1	Tmax_Ratkowsky_mu_A2	Tmax_Ratkowsky_mu_H	Tmin_Ratkowsky_mu_A1	Tmin_Ratkowsky_mu_A2	Tmin_Ratkowsky_mu_H K_SNH_aob1  K_SNH_aob2	K_SNO2_aob	K_SNO_aob	K_SO_aob1	K_SO_aob2   K_SO_AOBden1  K_IO_AOBden1  K_SO_AOBden2  K_IO_AOBden2  n_AOB  n_Y_AOB  K_FNA_aob K_FA_aob];PAR4 = [b_A1	b_A2	b_H	D_N2	D_N2O	D_NO	D_O2    F_BOD_COD	f_P	F_TSS_COD	H_N2	H_N2O	H_NO	i_X_B	i_X_P	k_a     K_FA	K_FNA	k_h     K_I10FA	K_I10FNA	K_I3NO	K_I4NO	K_I5NO	K_I9FA	K_I9FNA	K_N2O	K_NO	K_NO2	K_NO3	K_OA1	K_OA2	K_OH	K_OH1	K_OH2	K_OH3	K_OH4	K_OH5	K_S1	K_S2	K_S3	K_S4	K_S5	K_X		n_g2	n_g3	n_g4	n_g5	n_h     n_Y     pH	P_N2O_air	P_N2_air	P_NO_air	Y_A1    Y_A2    Y_H     X_I2TSS     X_S2TSS     X_BH2TSS    X_BA2TSS    X_P2TSS b_Ratkowsky_mu_A1	b_Ratkowsky_mu_A2	b_Ratkowsky_mu_H	c_Ratkowsky_mu_A1	c_Ratkowsky_mu_A2	c_Ratkowsky_mu_H	Temp_Ref	theta_b_A1	theta_b_A2	theta_b_H	theta_kla	theta_k_a	theta_k_h	Tmax_Ratkowsky_mu_A1	Tmax_Ratkowsky_mu_A2	Tmax_Ratkowsky_mu_H	Tmin_Ratkowsky_mu_A1	Tmin_Ratkowsky_mu_A2	Tmin_Ratkowsky_mu_H K_SNH_aob1  K_SNH_aob2	K_SNO2_aob	K_SNO_aob	K_SO_aob1	K_SO_aob2   K_SO_AOBden1  K_IO_AOBden1  K_SO_AOBden2  K_IO_AOBden2  n_AOB  n_Y_AOB  K_FNA_aob K_FA_aob];PAR5 = [b_A1	b_A2	b_H	D_N2	D_N2O	D_NO	D_O2    F_BOD_COD	f_P	F_TSS_COD	H_N2	H_N2O	H_NO	i_X_B	i_X_P	k_a     K_FA	K_FNA	k_h     K_I10FA	K_I10FNA	K_I3NO	K_I4NO	K_I5NO	K_I9FA	K_I9FNA	K_N2O	K_NO	K_NO2	K_NO3	K_OA1	K_OA2	K_OH	K_OH1	K_OH2	K_OH3	K_OH4	K_OH5	K_S1	K_S2	K_S3	K_S4	K_S5	K_X		n_g2	n_g3	n_g4	n_g5	n_h     n_Y     pH	P_N2O_air	P_N2_air	P_NO_air	Y_A1    Y_A2    Y_H     X_I2TSS     X_S2TSS     X_BH2TSS    X_BA2TSS    X_P2TSS b_Ratkowsky_mu_A1	b_Ratkowsky_mu_A2	b_Ratkowsky_mu_H	c_Ratkowsky_mu_A1	c_Ratkowsky_mu_A2	c_Ratkowsky_mu_H	Temp_Ref	theta_b_A1	theta_b_A2	theta_b_H	theta_kla	theta_k_a	theta_k_h	Tmax_Ratkowsky_mu_A1	Tmax_Ratkowsky_mu_A2	Tmax_Ratkowsky_mu_H	Tmin_Ratkowsky_mu_A1	Tmin_Ratkowsky_mu_A2	Tmin_Ratkowsky_mu_H K_SNH_aob1  K_SNH_aob2	K_SNO2_aob	K_SNO_aob	K_SO_aob1	K_SO_aob2   K_SO_AOBden1  K_IO_AOBden1  K_SO_AOBden2  K_IO_AOBden2  n_AOB  n_Y_AOB  K_FNA_aob K_FA_aob];% reactor volumesVOL1 = 1000;VOL2 = 1000;VOL3 = 1333;VOL4 = 1333;VOL5 = VOL3;% oxygen saturation concentration at 15 degC, based on BSM1SOSAT1 = 8;SOSAT2 = SOSAT1;SOSAT3 = SOSAT1;SOSAT4 = SOSAT1;SOSAT5 = SOSAT1;T = 0.0001; % used by hydraulic delaysQintrT = T*10;